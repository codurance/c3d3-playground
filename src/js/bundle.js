var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function f(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function s(t){return document.createTextNode(t)}function p(){return s(" ")}function d(){return s("")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}let g;function w(t){g=t}function v(t){(function(){if(!g)throw new Error("Function called outside component initialization");return g})().$$.on_mount.push(t)}const S=[],V=[],O=[],b=[],A=Promise.resolve();let x=!1;function _(t){O.push(t)}function y(){const t=new Set;do{for(;S.length;){const t=S.shift();w(t),N(t.$$)}for(;V.length;)V.pop()();for(let e=0;e<O.length;e+=1){const n=O[e];t.has(n)||(n(),t.add(n))}O.length=0}while(S.length);for(;b.length;)b.pop()();x=!1}function N(t){t.fragment&&(t.update(t.dirty),o(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(_))}const E=new Set;let M;function L(t,e){t&&t.i&&(E.delete(t),t.i(e))}function k(t,n,a){const{fragment:i,on_mount:u,on_destroy:l,after_update:c}=t.$$;i.m(n,a),_(()=>{const n=u.map(e).filter(r);l?l.push(...n):o(n),t.$$.on_mount=[]}),c.forEach(_)}function R(t,e){t.$$.fragment&&(o(t.$$.on_destroy),t.$$.fragment.d(e),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function B(t,e){t.$$.dirty||(S.push(t),x||(x=!0,A.then(y)),t.$$.dirty=n()),t.$$.dirty[e]=!0}function z(e,r,a,i,u,l){const c=g;w(e);const f=r.props||{},s=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:[]),callbacks:n(),dirty:null};let p=!1;var d;s.ctx=a?a(e,f,(t,n)=>{s.ctx&&u(s.ctx[t],s.ctx[t]=n)&&(s.bound[t]&&s.bound[t](n),p&&B(e,t))}):f,s.update(),p=!0,o(s.before_update),s.fragment=i(s.ctx),r.target&&(r.hydrate?s.fragment.l((d=r.target,Array.from(d.childNodes))):s.fragment.c(),r.intro&&L(e.$$.fragment),k(e,r.target,r.anchor),y()),w(c)}class T{$destroy(){R(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}function j(t,e,n){const o=Object.create(t);return o.feature=e[n],o}function q(e){var n;return{c(){n=s("loading")},m(t,e){u(t,n,e)},p:t,d(t){t&&l(n)}}}function P(t){for(var e,n=t.features,o=[],r=0;r<n.length;r+=1)o[r]=C(j(t,n,r));return{c(){for(var t=0;t<o.length;t+=1)o[t].c();e=d()},m(t,n){for(var r=0;r<o.length;r+=1)o[r].m(t,n);u(t,e,n)},p(t,r){if(t.path||t.features||t.quantize||t.Number||t.filter){n=r.features;for(var a=0;a<n.length;a+=1){const i=j(r,n,a);o[a]?o[a].p(t,i):(o[a]=C(i),o[a].c(),o[a].m(e.parentNode,e))}for(;a<o.length;a+=1)o[a].d(1);o.length=n.length}},d(t){!function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(o,t),t&&l(e)}}}function C(t){var e,n,r,a,c,p,d,g=t.feature.properties.NOMABS.replace("Barcelona - ","")+"";function w(...e){return t.mousemove_handler(t,...e)}return{c(){var o,i,u;e=f("path"),a=f("text"),c=s(g),m(e,"d",n=t.path(t.feature)),m(e,"fill",r=t.quantize(t.Number(t.feature.properties.VALORES?t.feature.properties.VALORES[t.filter]:0))),m(e,"stroke","black"),o="font-size",i="10px",a.style.setProperty(o,i,u?"important":""),m(a,"transform",p=`translate(${t.path.centroid(t.feature)})`),d=[h(e,"mouseover",t.handleMouseOver),h(e,"mousemove",w),h(e,"mouseout",t.handleMouseOut(t.feature))]},m(t,n){u(t,e,n),u(t,a,n),i(a,c)},p(o,i){t=i,o.features&&n!==(n=t.path(t.feature))&&m(e,"d",n),(o.quantize||o.features||o.filter)&&r!==(r=t.quantize(t.Number(t.feature.properties.VALORES?t.feature.properties.VALORES[t.filter]:0)))&&m(e,"fill",r),o.features&&g!==(g=t.feature.properties.NOMABS.replace("Barcelona - ","")+"")&&$(c,g),o.features&&p!==(p=`translate(${t.path.centroid(t.feature)})`)&&m(a,"transform",p)},d(t){t&&(l(e),l(a)),o(d)}}}function G(t){var e,n,o,r,a,f,d,h,g,w,v,S,V,O=t.tooltipValues.NOMABS+"",b=t.tooltipValues.NOMAGA+"",A=t.tooltipValues.NOMSS+"",x=t.tooltipValues.VALORES?t.tooltipValues.VALORES[t.filter]:"No Data";return{c(){e=c("div"),n=c("p"),o=s(O),r=p(),a=c("p"),f=s(b),d=p(),h=c("p"),g=s(A),w=p(),v=c("p"),S=s(x),m(e,"class","tooltip svelte-13vpjdb"),m(e,"style",V=t.showTooltip?`opacity: .9; top: ${t.tooltipValues.top}px; left: ${t.tooltipValues.left}px`:"opacity: 0")},m(t,l){u(t,e,l),i(e,n),i(n,o),i(e,r),i(e,a),i(a,f),i(e,d),i(e,h),i(h,g),i(e,w),i(e,v),i(v,S)},p(t,n){t.tooltipValues&&O!==(O=n.tooltipValues.NOMABS+"")&&$(o,O),t.tooltipValues&&b!==(b=n.tooltipValues.NOMAGA+"")&&$(f,b),t.tooltipValues&&A!==(A=n.tooltipValues.NOMSS+"")&&$(g,A),(t.tooltipValues||t.filter)&&x!==(x=n.tooltipValues.VALORES?n.tooltipValues.VALORES[n.filter]:"No Data")&&$(S,x),(t.showTooltip||t.tooltipValues)&&V!==(V=n.showTooltip?`opacity: .9; top: ${n.tooltipValues.top}px; left: ${n.tooltipValues.left}px`:"opacity: 0")&&m(e,"style",V)},d(t){t&&l(e)}}}function D(e){var n,r,a,s,$,g,w,v,S,V,O,b,A,x;function _(t,e){return e.features?P:q}var y=_(0,e),N=y(e),E=e.showTooltip&&G(e);return{c(){n=c("div"),r=c("div"),(a=c("button")).textContent="filter 1",s=p(),($=c("button")).textContent="filter 2",g=p(),(w=c("button")).textContent="filter 3",v=p(),S=f("svg"),V=f("g"),N.c(),b=p(),E&&E.c(),A=d(),m(S,"viewBox",O=`0 0 ${e.width||0} ${e.height||0}`),m(n,"id","map"),x=[h(a,"click",e.click_handler),h($,"click",e.click_handler_1),h(w,"click",e.click_handler_2)]},m(t,e){u(t,n,e),i(n,r),i(r,a),i(r,s),i(r,$),i(r,g),i(r,w),i(n,v),i(n,S),i(S,V),N.m(V,null),u(t,b,e),E&&E.m(t,e),u(t,A,e)},p(t,e){y===(y=_(0,e))&&N?N.p(t,e):(N.d(1),(N=y(e))&&(N.c(),N.m(V,null))),(t.width||t.height)&&O!==(O=`0 0 ${e.width||0} ${e.height||0}`)&&m(S,"viewBox",O),e.showTooltip?E?E.p(t,e):((E=G(e)).c(),E.m(A.parentNode,A)):E&&(E.d(1),E=null)},i:t,o:t,d(t){t&&l(n),N.d(),t&&l(b),E&&E.d(t),t&&l(A),o(x)}}}const F="https://gist.githubusercontent.com/damianpumar/862fe8d75f92a0b114ad4ae2bf128e13/raw/21dc4b07207455034b1e48022ae53f3a84fe5ece/finaltopojson";function H(t,e,n){const o=d3.geoPath();let r,a,i,u=[0,0];v(async()=>{const t=await fetch(F);i=await t.json(),n("features",a=await topojson.feature(i,i.objects.ABS_2018).features),n("colorScaleExtent",u=d3.extent(i.objects.ABS_2018.geometries.map(({properties:t})=>t.VALORES?t.VALORES[d]:0))),n("widthParent",r=d3.select("#map").node().getBoundingClientRect().width)});const l=["#ffffff","#ffd333","#ffde66","#fff4cc","#ffe999"];function c(t){n("filter",d=t)}function f(t,e){const{NOMABS:o,NOMAGA:r,NOMSS:a,VALORES:i}=t.properties;n("tooltipValues",g={NOMABS:o,NOMAGA:r,NOMSS:a,VALORES:i,left:e.clientX,top:e.clientY})}let s,p,d,h,m,$,g;return t.$$.update=((t={widthParent:1,colorScaleExtent:1})=>{t.widthParent&&n("width",s=r),t.widthParent&&n("height",p=r/.5),t.colorScaleExtent&&n("quantize",h=d3.scaleQuantize().domain(u).range(l))}),n("filter",d=0),m=null,n("showTooltip",$=!1),n("tooltipValues",g={}),{path:o,features:a,setFilter:c,handleMouseOver:function(){n("showTooltip",$=!0),(m=d3.select(this)).attr("fill","orange")},handleMouseMove:f,handleMouseOut:t=>()=>{n("showTooltip",$=!1);const e=h(Number(t.properties.VALORES?t.properties.VALORES[d]:0));m.attr("fill",e)},width:s,height:p,filter:d,quantize:h,showTooltip:$,tooltipValues:g,Number:Number,click_handler:function(){return c(0)},click_handler_1:function(){return c(1)},click_handler_2:function(){return c(2)},mousemove_handler:function({feature:t},e){return f(t,e)}}}class Q extends T{constructor(t){super(),z(this,t,H,D,a,[])}}function X(t){var e,n,o,r,a,f,d=new Q({});return{c(){e=c("h1"),n=s("Hello "),o=s(t.name),r=s("!"),a=p(),d.$$.fragment.c(),m(e,"class","svelte-1ucbz36")},m(t,l){u(t,e,l),i(e,n),i(e,o),i(e,r),u(t,a,l),k(d,t,l),f=!0},p(t,e){f&&!t.name||$(o,e.name)},i(t){f||(L(d.$$.fragment,t),f=!0)},o(t){!function(t,e,n,o){if(t&&t.o){if(E.has(t))return;E.add(t),M.c.push(()=>{E.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}(d.$$.fragment,t),f=!1},d(t){t&&(l(e),l(a)),R(d,t)}}}function Y(t,e,n){let{name:o}=e;return t.$set=(t=>{"name"in t&&n("name",o=t.name)}),{name:o}}return new class extends T{constructor(t){super(),z(this,t,Y,X,a,["name"])}}({target:document.querySelector("#svelte-hook"),props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
